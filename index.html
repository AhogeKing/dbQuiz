<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>选择题刷题程序</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
            line-height: 1.6;
        }

        h1 {
            text-align: center
        }

        .hidden {
            display: none
        }

        .option-label {
            display: block;
            margin: 6px 0
        }

        .feedback {
            margin-top: 12px;
            font-weight: bold
        }

        .correct {
            color: green
        }

        .incorrect {
            color: #d33
        }

        .wrong-question {
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 8px 12px;
            margin: 10px 0
        }

        /* ---------- 响应式布局 ---------- */
        /* 手机（如 iPhone 13 Pro，最大 480px） */
        @media (max-width: 480px) {
            body {
                padding: 16px;
                font-size: 16px;
            }
            h1 {
                font-size: 1.5rem;
            }
            button {
                font-size: 1rem;
            }
        }

        /* 平板（如 iPad Air 10.9"，481px–1024px） */
        @media (min-width: 481px) and (max-width: 1024px) {
            body {
                padding: 20px;
                font-size: 18px;
            }
            h1 {
                font-size: 2rem;
            }
            button {
                font-size: 1.1rem;
            }
        }

        /* 桌面大屏（如 27" 4K 显示器，≥1600px） */
        @media (min-width: 1600px) {
            body {
                font-size: 20px;
            }
            h1 {
                font-size: 2.5rem;
            }
            .option-label {
                font-size: 1.1rem;
            }
        }
    </style>
</head>

<body>
    <h1>刷题小助手</h1>

    <!-- ========== 起始界面 ========== -->
    <div id="setup">
        <label for="chapterSelect">请选择章节：</label>
        <select id="chapterSelect">
            <option value="1">第一章</option>
            <option value="2">第二章</option>
            <option value="3">第三章</option>
            <option value="4">第四章</option>
            <option value="5">第五章</option>
            <option value="6">第六章</option>
            <option value="all">所有章节</option>
        </select>
        <button id="startBtn">开始答题</button>
    </div>

    <!-- ========== 做题界面 ========== -->
    <div id="quizArea" class="hidden">
        <div id="progress"></div>
        <p id="questionText"></p>
        <form id="optionsForm"></form>
        <button id="prevBtn" disabled>上一题</button>
        <button id="submitBtn">提交答案</button>
        <div id="feedback" class="feedback"></div>
    </div>

    <!-- ========== 结果界面 ========== -->
    <div id="resultsArea" class="hidden">
        <h2>答题完成！</h2>
        <p id="scoreText"></p>
        <div id="wrongList"></div>
        <button id="restartBtn">重新开始</button>
    </div>

    <script>
        // ---------- 第一章题库 ----------
        const CHAPTER_1 = [
            { "id": 1, "text": "在数据操纵语言(DML)的基本功能中，不包括的是", "options": ["插入新数据", "描述数据库结构", "更新数据", "删除数据库中数据"], "answer": 1 },
            { "id": 2, "text": "下面哪个不是数据库技术的主要特点", "options": ["数据的冗余度小", "程序的标准化", "数据的独立性高", "数据的结构化"], "answer": 1 },
            { "id": 3, "text": "设有课程关系Course（课程号，课程名，学分，开设专业号，先修课程号）和专业关系Speciality（专业号，专业名）和课程关系Course的外键是？", "options": ["先修课程号", "开设专业号", "开设专业号和先修课程号", "课程号"], "answer": 2 },
            { "id": 4, "text": "数据库的三级模式之间存在着两级映像，使得数据库系统具有较高的", "options": ["数据独立性", "事务并发性", "数据可靠性", "数据重用性"], "answer": 0 },
            { "id": 5, "text": "DBS是( )的简写。", "options": ["数据库管理系统", "数据库", "数据库系统", "操作系统"], "answer": 2 },
            { "id": 6, "text": "要保证数据库的物理独立性，需要修改的是( )", "options": ["内模式", "模式", "模式与内模式的映射", "模式与外模式的映射"], "answer": 2 },
            { "id": 7, "text": "数据视图属于三级模式中的 ( )", "options": ["存储模式", "内模式", "外模式", "模式"], "answer": 2 },
            { "id": 8, "text": "位于用户和数据库之间的一层数据管理软件是 ( ) ", "options": ["DBS", "DB", "MIS", "DBMS"], "answer": 3 },
            { "id": 9, "text": "下列不属于数据库管理系统的是（ ）", "options": ["Python", "Oracle", "SQL server", "MySQL"], "answer": 0 },
            { "id": 10, "text": "在关系数据库中，参照完整性要求基本关系的( )。", "options": ["外码的取值必须为空值或等于被参照关系某元组的主码值", "主属性的取值不能为空", "外码的取值不能为空", "外码的取值不能相同"], "answer": 0 },
            { "id": 11, "text": "要保证数据库的逻辑独立性，需要修改的是( )。", "options": ["内模式", "模式与外模式的映射", "模式与内模式的映射", "模式"], "answer": 1 },
            { "id": 12, "text": "数据管理技术发展过程中, ( )不是文件系统阶段的特点。", "options": ["数据冗余度大", "数据独立性低", "能长期保存数据", "共享度高"], "answer": 3 },
            { "id": 13, "text": "设F是关系模式R(A，B，C)的FD集，F={A→BC，B→C，A→B，AB→C}，则R的最小函数依赖集Fm是(   )。", "options": ["Fm={A→B,B→C}", "Fm={B→C}", "Fm={A→C}", "Fm={A→B}"], "answer": 0 },
            { "id": 14, "text": "在数据定义语言(DDL)的基本功能中，不包括的是( )。", "options": ["修改数据库中数据", "描述数据库结构", "描述数据库逻辑结构", "描述数据库物理结构"], "answer": 0 },
            { "id": 15, "text": "关系数据模型的三类完整性约束中，不包括( )", "options": ["实体完整性", "用户自定义完整性", "参照完整性", "结构完整性"], "answer": 3 },
            { "id": 16, "text": "查询选修了课程号为C2或C4课程的学生学号，下面写法正确的是( )", "options": ["Πcno(σcno='C2' ∨cno='C4' (C))", "Πsno(σcno='C2' ∨cno='C4' (SC))", "Πsno(σcno='C2' ∨cno='C4' (C))", "Πsno(σcno='C2' or cno='C4' (S))"], "answer": 1 },
            { "id": 17, "text": "DBMS是( )的简写", "options": ["数据库管理系统", "数据", "数据库系统", "数据库"], "answer": 0 },
            { "id": 18, "text": "关系模式R(U，F)中，U={A，B，C，D，E，G}，F={B→D，DG→C,BD→E,AG→B,ADG→BC}；则R的最小函数依赖集Fm是(   )。", "options": ["Fm={B→D,DG→C,BD→E}", "Fm={B→D,DG→C,BD→E,AG→B}", "Fm={B→D,DG→C,AG→B}", "Fm={B→D,BD→E,AG→B}"], "answer": 1 },
            { "id": 19, "text": "以下操作中，是用数据控制语言(DCL)实现的是 ( )", "options": ["数据查询", "数据插入", "模式定义", "安全控制"], "answer": 3 },
            { "id": 20, "text": "在下列四项中，不属于数据库系统的特点的是( )", "options": ["数据由 DBMS 统一管理和控制", "数据结构化", "数据独立性", "数据冗余度大"], "answer": 3 },
            { "id": 21, "text": "基本表属于三级模式中的 ( )", "options": ["内模式", "存储模式", "外模式", "模式"], "answer": 3 },
            { "id": 22, "text": "在关系数据库中，实体完整性要求基本关系的( )", "options": ["主属性的取值不能为空", "主属性的取值不能相同", "外码的取值不能为空", "外码的取值不能相同"], "answer": 0 },
            { "id": 23, "text": "查询选修了课程名为概率统计的学生学号与姓名，下面写法正确的是( )", "options": ["Πsno,sname((Πsno(SC) ∞Πcno,sname(S)) ∞(Πcno(σcname='概率统计' (C))))", "Πcno,cname(σcname='概率统计'(S ∞SC ∞C))", "Πsno,sname((Πsno,cno(SC) ∞Πsno,sname(S)) ∞(Πcno(σcname='概率统计' (C))))", "Πsno,sname(σcno='概率统计'(S ∞SC ∞C))"], "answer": 2 },
            { "id": 24, "text": "设关系模式R( A,B,C,D,E,P), 其函数依赖集:F={A→D, E→D, D→B, BC→D, DC→A}，则R的候选码是", "options": ["AEP", "CFP", "CEF", "CEP"], "answer": 3 },
            { "id": 25, "text": "( )是提供数据库管理的计算机系统软件", "options": ["管理信息系统", "数据库系统", "数据库管理系统", "数据库应用系统"], "answer": 2 },
            { "id": 26, "text": "存储结构属于三级模式中的 ( )", "options": ["内模式", "外模式", "模式", "存储模式"], "answer": 0 },
            { "id": 27, "text": "已知关系模式R<U, F>，U是属性全集，F是U上的函数依赖集，其中U={A, B, C, D, E}，F={AB→C, B→D, C→E, EC→B, AC→B}，则(AB)+的值是( )", "options": ["ABC", "ABCDE", "ACE", "ABE"], "answer": 1 },
            { "id": 28, "text": "一个基本关系中，主属性( )", "options": ["只有一个", "可以是零个", "以上都不是", "可以有多个"], "answer": 3 },
            { "id": 29, "text": "DB、DBMS和DBS之间的关系是 ( )", "options": ["DB包含DBMS和DBS", "DBMS包含DB", "DBS包含DBMS和DB", "DBMS包含DB和DBS"], "answer": 2 },
            { "id": 30, "text": "设某教学数据库中有三个关系模式... 查询选修了课程号为C2课程的学生学号与姓名，下面写法正确的是( )", "options": ["Πsno(σcname='C2' (SC))∞Πsno,sname(S)", "Πsno(σcno='C2' (SC))∞Πsno,sname(S)", "Πsno(σcno='C2' (S ))∞Πsno,sname(SC)", "Πsno(σsno='C2' (SC))∞Πsno,cname(S)"], "answer": 1 }
        ];

        // ---------- 预留其它章节 ----------
        const CHAPTER_2 = [
            { "id": 1, "text": "下面不属于数据库运行和维护阶段工作的是 ( )", "options": ["测试应用程序功能", "数据库备份和恢复生产", "数据库安全性控制", "数据库性能的监督和分析"], "answer": 0 },
            { "id": 2, "text": "某学校的综合管理系统设计阶段，“职称”在学籍管理子系统中被表示为属性，而在人事管理子系统中被表示为实体集，这类冲突被称之为( )", "options": ["语义冲突", "结构冲突", "命名冲突", "属性冲突"], "answer": 1 },
            { "id": 3, "text": "需求分析最常用的方法是( )的分析方法。", "options": ["自顶向下", "自底向上", "逐步扩张", "由外面内"], "answer": 0 },
            { "id": 4, "text": "逻辑结构设计阶段得到的结果是( )", "options": ["E-R图表示的概念模型", "某个DBMS所支持的数据模型", "包括存储结构和存取方法的物理结构", "数据字典描述的数据需求"], "answer": 1 },
            { "id": 5, "text": "负责DBS的正常运行，承担创建、监控和维护数据库结构责任的数据库用户是( )", "options": ["DBA", "应用程序员", "终端用户", "专业用户"], "answer": 0 },
            { "id": 6, "text": "数据库应用系统设计的需求分析阶段生成的文档主要有数据字典和( )", "options": ["数据流图", "UML图", "功能模块图", "E-R图"], "answer": 0 },
            { "id": 7, "text": "概念结构设计阶段得到的结果是( )", "options": ["数据字典描述的数据需求", "某个DBMS所支持的数据模型", "包括存储结构和存取方法的物理结构", "E-R图表示的概念模型"], "answer": 3 },
            { "id": 8, "text": "数据库物理设计的主要内容是( )。", "options": ["E-R图", "数据流图", "都不是", "存储结构和存取方法"], "answer": 3 },
            { "id": 9, "text": "下面除了( )之外都属性数据抽象的基本方法 。", "options": ["分类", "概括", "分解", "聚集"], "answer": 2 },
            { "id": 10, "text": "概念结构设计最常用的方法是( )的设计方法。", "options": ["自顶向下", "由外面内", "自底向上", "逐步扩张"], "answer": 2 },
            { "id": 11, "text": "某学校的综合管理系统设计阶段，“学号”在学籍管理子系统中被定义为整型，而在财务管理子系统中被定义为字符型，这类冲突被称之为( )。", "options": ["语义冲突", "属性冲突", "结构冲突", "命名冲突"], "answer": 1 },
            { "id": 12, "text": "下面不属于数据库实施阶段工作的是 ( )", "options": ["测试应用程序功能", "数据库重组和重构", "测试数据库性能", "数据的录入"], "answer": 1 },
            { "id": 13, "text": "“关系模式的优化”这一设计内容主要 属于( )设计阶段。", "options": ["代码设计", "概念设计", "物理设计", "逻辑设计"], "answer": 3 },
            { "id": 14, "text": "一个职工可参加多项比赛，一项比赛可多个职工参加，在用E-R图描述职工和比赛项目之间的联系图中,联系转换为关系模式时,该关系模式的码为( )", "options": ["职工和比赛项目的码的组合", "比赛项目的码", "以上三者都不是", "职工的码"], "answer": 0 },
            { "id": 15, "text": "某学校的综合管理系统设计阶段，教师实体在学籍管理子系统中被称为“教师”，而在人事管理子系统中被称为“职工”，这类冲突被称之为( )。", "options": ["语义冲突", "结构冲突", "命名冲突", "属性冲突"], "answer": 2 },
        ];
        const CHAPTER_3 = [];
        const CHAPTER_4 = [];
        const CHAPTER_5 = [];
        const CHAPTER_6 = [];

        /* ========== 逻辑实现 ========== */
        function shuffle(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[arr[i], arr[j]] = [arr[j], arr[i]]; } return arr; }
        let questions = [], idx = 0, userAnswers = [];
        let awaitingNext = false;

        const $ = (id) => document.getElementById(id);
        $('startBtn').onclick = startQuiz;
        $('submitBtn').onclick = submitAnswer;
        $('prevBtn').onclick = prevQuestion;
        $('restartBtn').onclick = () => { $('resultsArea').classList.add('hidden'); $('setup').classList.remove('hidden'); };

        function startQuiz() {
            const sel = $('chapterSelect').value;
            questions = [
                ...(sel === '1' ? CHAPTER_1 : []),
                ...(sel === '2' ? CHAPTER_2 : []),
                ...(sel === '3' ? CHAPTER_3 : []),
                ...(sel === '4' ? CHAPTER_4 : []),
                ...(sel === '5' ? CHAPTER_5 : []),
                ...(sel === '6' ? CHAPTER_6 : []),
                ...(sel === 'all' ? CHAPTER_1.concat(CHAPTER_2, CHAPTER_3, CHAPTER_4, CHAPTER_5, CHAPTER_6) : [])
            ];
            if (!questions.length) { alert('该章节暂未添加题目！'); return; }
            shuffle(questions);
            idx = 0;
            userAnswers = new Array(questions.length).fill(null);
            awaitingNext = false;
            $('setup').classList.add('hidden'); $('quizArea').classList.remove('hidden');
            render();
        }

        function render() {
            const q = questions[idx];
            $('progress').textContent = `题目 ${idx + 1} / ${questions.length}`;
            $('questionText').textContent = q.text;
            const f = $('optionsForm'); f.innerHTML = '';
            q.options.forEach((op, i) => {
                f.insertAdjacentHTML('beforeend',
                    `<label class="option-label"><input type="radio" name="opt" value="${i}"> ${String.fromCharCode(65 + i)}. ${op}</label>`);
            });
            // 恢复已做答案并显示反馈
            const saved = userAnswers[idx];
            if (saved !== null) {
                document.querySelector(`input[name="opt"][value="${saved}"]`).checked = true;
                const ca = q.answer;
                if (saved === ca) {
                    $('feedback').textContent = '回答正确！';
                    $('feedback').classList.add('correct');
                } else {
                    $('feedback').textContent = `回答错误！正确答案是 ${String.fromCharCode(65 + ca)}.`;
                    $('feedback').classList.add('incorrect');
                }
                awaitingNext = true;
                $('submitBtn').textContent = idx + 1 === questions.length ? '查看结果' : '下一题';
            } else {
                $('feedback').textContent = '';
                $('feedback').className = 'feedback';
                awaitingNext = false;
                $('submitBtn').textContent = '提交答案';
            }
            // 首题禁用“上一题”
            $('prevBtn').disabled = (idx === 0);
        }

        function submitAnswer() {
            if (!awaitingNext) {
                const sel = document.querySelector('input[name="opt"]:checked');
                if (!sel) { alert('请选择一个选项！'); return; }
                const ua = +sel.value, ca = questions[idx].answer;
                if (ua === ca) {
                    $('feedback').textContent = '回答正确！';
                    $('feedback').classList.add('correct');
                } else {
                    $('feedback').textContent = `回答错误！正确答案是 ${String.fromCharCode(65 + ca)}.`;
                    $('feedback').classList.add('incorrect');
                }
                userAnswers[idx] = ua;
                awaitingNext = true;
                $('submitBtn').textContent = idx + 1 === questions.length ? '查看结果' : '下一题';
            } else {
                awaitingNext = false; idx++;
                if (idx < questions.length) render(); else showResult();
            }
        }

        function prevQuestion() {
            if (idx === 0) return;
            idx--;
            render();
        }

        function showResult() {
            $('quizArea').classList.add('hidden');
            $('resultsArea').classList.remove('hidden');
            let correctCount = 0;
            const wrongItems = [];
            userAnswers.forEach((ua, i) => {
                if (ua === questions[i].answer) {
                    correctCount++;
                } else {
                    wrongItems.push({ q: questions[i], ua });
                }
            });
            const acc = (correctCount / questions.length * 100).toFixed(2);
            $('scoreText').textContent = `共回答 ${questions.length} 题，正确 ${correctCount} 题，正确率 ${acc}%`;
            const wl = $('wrongList'); wl.innerHTML = '';
            if (!wrongItems.length) {
                wl.textContent = '全部答对，恭喜！';
                return;
            }
            wrongItems.forEach((w, i) => {
                wl.insertAdjacentHTML('beforeend',
                    `<div class="wrong-question"><strong>题目${i + 1}：</strong>${w.q.text}<br>
                     你的答案：${String.fromCharCode(65 + w.ua)}. ${w.q.options[w.ua]}<br>
                     正确答案：${String.fromCharCode(65 + w.q.answer)}. ${w.q.options[w.q.answer]}</div>`);
            });
        }
    </script>
</body>

</html>